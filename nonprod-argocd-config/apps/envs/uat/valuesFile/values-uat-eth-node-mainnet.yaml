# Ethereum Node Configuration for UAT - Ethereum Mainnet
# Geth (Execution Layer) + Prysm (Consensus Layer)
# Production-ready configuration with 2TB persistence

global:
  network: mainnet
  checkpointSync:
    enabled: true
# Geth Execution Client Configuration
# Latest version: v1.16.7 (Fusaka hardfork support - Dec 3, 2025)
geth:
  enabled: true
  nameOverride: execution
  # Schedule on dedicated eth-mainnet node
  # IMPORTANT: Create a dedicated node with taint: ethereum=mainnet:NoSchedule
  # Update the hostname below to match your mainnet node
  nodeSelector:
    kubernetes.io/hostname: aks-ethmainnet-11656774-vmss000000
  tolerations:
    - key: "ethereum"
      operator: "Equal"
      value: "mainnet"
      effect: "NoSchedule"
  image:
    repository: ethereum/client-go
    tag: v1.16.7
    pullPolicy: IfNotPresent
  # Mainnet network configuration
  extraArgs:
    - --mainnet
    - --http
    - --http.addr=0.0.0.0
    - --http.api=eth,net,web3,engine,admin,debug
    - --http.vhosts=*
    - --http.corsdomain=*
    - --ws
    - --ws.addr=0.0.0.0
    - --ws.api=eth,net,web3,engine
    - --ws.origins=*
    - --authrpc.addr=0.0.0.0
    - --authrpc.vhosts=*
    - --metrics
    - --metrics.addr=0.0.0.0
    - --syncmode=snap
    - --cache=16384
    - --maxpeers=100
    - --nat=any
  # 2TB Persistence for execution layer (mainnet requires more storage than testnets)
  persistence:
    enabled: true
    size: 2Ti
    storageClassName: premium2-disk-sc
    accessModes:
      - ReadWriteOnce
  # Mainnet requires more resources than Sepolia
  resources:
    requests:
      cpu: 6000m
      memory: 24Gi
    limits:
      cpu: 12000m
      memory: 48Gi
  # Service configuration
  httpPort: 8545
  wsPort: 8546
  p2pPort: 30303
  metricsPort: 6060
  # P2P NodePort disabled (use ClusterIP instead)
  p2pNodePort:
    enabled: false
  # Liveness and readiness probes
  livenessProbe:
    initialDelaySeconds: 300
    periodSeconds: 30
    timeoutSeconds: 10
    failureThreshold: 3
  readinessProbe:
    initialDelaySeconds: 60
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  # Pod disruption budget disabled (empty object = disabled)
  podDisruptionBudget: {}
  # Termination grace period for clean shutdown
  terminationGracePeriodSeconds: 600
  # Service account
  serviceAccount:
    create: true
# Prysm Consensus Client Configuration
# Latest version: v7.1.1 (Fulu hardfork support)
prysm:
  enabled: true
  nameOverride: beacon
  # Schedule on dedicated eth-mainnet node
  # IMPORTANT: Create a dedicated node with taint: ethereum=mainnet:NoSchedule
  # Update the hostname below to match your mainnet node
  nodeSelector:
    kubernetes.io/hostname: aks-ethmainnet-11656774-vmss000000
  tolerations:
    - key: "ethereum"
      operator: "Equal"
      value: "mainnet"
      effect: "NoSchedule"
  image:
    repository: gcr.io/offchainlabs/prysm/beacon-chain
    tag: stable
    pullPolicy: IfNotPresent
  # Mainnet network with checkpoint sync
  extraArgs:
    - --mainnet
    - --accept-terms-of-use
    - --execution-endpoint=http://uat-eth-node-mainnet-execution:8551
    - --rpc-host=0.0.0.0
    - --grpc-gateway-host=0.0.0.0
    - --monitoring-host=0.0.0.0
    - --p2p-max-peers=150
    - --block-batch-limit=512
    - --block-batch-limit-burst-factor=10
    - --checkpoint-sync-url=https://checkpoint-sync.ethpandaops.io
    - --genesis-beacon-api-url=https://checkpoint-sync.ethpandaops.io
  # Checkpoint sync for faster initial sync
  checkpointSync:
    enabled: true
    url: https://checkpoint-sync.ethpandaops.io
  # Persistence for consensus layer (mainnet beacon chain is larger than testnet)
  persistence:
    enabled: true
    size: 1Ti
    storageClassName: premium2-disk-sc
    accessModes:
      - ReadWriteOnce
  # Mainnet requires more resources than Sepolia
  resources:
    requests:
      cpu: 3000m
      memory: 12Gi
    limits:
      cpu: 6000m
      memory: 24Gi
  # Service ports
  httpPort: 5052
  p2pPort: 9000
  metricsPort: 8080
  # P2P NodePort disabled (use ClusterIP instead)
  p2pNodePort:
    enabled: false
  # Liveness and readiness probes
  livenessProbe:
    initialDelaySeconds: 300
    periodSeconds: 30
    timeoutSeconds: 10
    failureThreshold: 3
  readinessProbe:
    initialDelaySeconds: 60
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  # Pod disruption budget disabled (empty object = disabled)
  podDisruptionBudget: {}
  # Termination grace period
  terminationGracePeriodSeconds: 600
  # Service account
  serviceAccount:
    create: true
# Ethereum Metrics Exporter for monitoring
ethereum-metrics-exporter:
  enabled: true
  config:
    consensus:
      enabled: true
      url: http://{{ .Release.Name }}-beacon:5052
    execution:
      enabled: true
      url: http://{{ .Release.Name }}-execution:8545
      modules:
        - eth
        - net
        - web3
# Disable other clients (only using Geth + Prysm)
besu:
  enabled: false
erigon:
  enabled: false
ethereumjs:
  enabled: false
nethermind:
  enabled: false
reth:
  enabled: false
grandine:
  enabled: false
lighthouse:
  enabled: false
lodestar:
  enabled: false
nimbus:
  enabled: false
teku:
  enabled: false
xatu-sentry:
  enabled: false
tracoor-agent:
  enabled: false
enclave:
  image:
    tag: 41ee3f7
enclave02:
  image:
    tag: 41ee3f7
host:
  image:
    tag: 41ee3f7
